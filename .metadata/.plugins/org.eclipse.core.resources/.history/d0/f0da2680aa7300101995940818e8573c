<%-- <%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add New Medicine</title>
       <link rel="stylesheet" href="./CSS/forAddMed.cc">
</head>
<body>

    <div class="container">
        <h2>Add New Medicine</h2>
        <form action="AddMedicineServlet" method="post">
            <label for="name">Medicine Name:</label>
            <input type="text" name="name" id="name" required>

            <label for="company">Company:</label>
            <input type="text" name="company" id="company" required>

            <label for="price">Price (₹):</label>
            <input type="number" name="price" id="price" step="0.01" required>

            <label for="quantity">Quantity:</label>
            <input type="number" name="quantity" id="quantity" required>

            <label for="expiry">Expiry Date:</label>
            <input type="date" name="expiry" id="expiry" required>

            <button type="submit">Add Medicine</button>
        </form>

        <a class="back" href="dashboard.jsp">← Back to Dashboard</a>
    </div>

</body>
</html>
 --%>
 
 
 <%@ page import="java.sql.*" %>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add New Medicine</title>
    <link rel="stylesheet" href="./CSS/forAddMed.css">
    <style>
        .success-box {
            background-color: #d4edda;
            border: 1px solid #28a745;
            color: #155724;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .error-box {
            background-color: #f8d7da;
            border: 1px solid #dc3545;
            color: #721c24;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .container {
            width: 400px;
            margin: auto;
            padding: 20px;
        }

        form input, form button {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px 0;
        }

        .back {
            text-decoration: none;
            display: block;
            margin-top: 10px;
        }
    </style>
</head>
<body>

<%
    boolean inserted = false;
    boolean error = false;

    if ("POST".equalsIgnoreCase(request.getMethod())) {
        String name = request.getParameter("name");
        String company = request.getParameter("company");
        String priceStr = request.getParameter("price");
        String quantityStr = request.getParameter("quantity");
        String expiry = request.getParameter("expiry");

        try {
            double price = Double.parseDouble(priceStr);
            int quantity = Integer.parseInt(quantityStr);

            Class.forName("com.mysql.cj.jdbc.Driver");
            Connection conn = DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/med2025", "root", "root@123"
            );

            String sql = "INSERT INTO medicine (name, company, price, quantity, expiry_date) VALUES (?, ?, ?, ?, ?)";
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setString(1, name);
            stmt.setString(2, company);
            stmt.setDouble(3, price);
            stmt.setInt(4, quantity);
            stmt.setDate(5, java.sql.Date.valueOf(expiry));

            int rows = stmt.executeUpdate();

            if (rows > 0) inserted = true;

            stmt.close();
            conn.close();
        } catch (Exception e) {
            error = true;
        }
    }
%>

<div class="container">
    <h2>Add New Medicine</h2>

    <% if (inserted) { %>
        <div class="success-box">
            ✅ Medicine added successfully!
        </div>
        <form action="addMedicine.jsp" method="get">
            <button type="submit">➕ Add More Medicine</button>
        </form>
        <a class="back" href="dashboard.jsp">← Back to Dashboard</a>
    <% } else if (error) { %>
        <div class="error-box">
            ❌ Error occurred while adding medicine. Please try again.
        </div>
    <% } %>

    <% if (!inserted) { %>
        <form action="addMedicine.jsp" method="post">
            <label for="name">Medicine Name:</label>
            <input type="text" name="name" id="name" required>

            <label for="company">Company:</label>
            <input type="text" name="company" id="company" required>

            <label for="price">Price (₹):</label>
            <input type="number" name="price" id="price" step="0.01" required>

            <label for="quantity">Quantity:</label>
            <input type="number" name="quantity" id="quantity" required>

            <label for="expiry">Expiry Date:</label>
            <input type="date" name="expiry" id="expiry" required>

            <button type="submit">Add Medicine</button>
        </form>
        <a class="back" href="dashboard.jsp">← Back to Dashboard</a>
    <% } %>
</div>

</body>
</html>
 